module.exports = {
  parser: '@typescript-eslint/parser',
  parserOptions: {
    project: './tsconfig.json',
    extraFileExtensions: ['.svelte'],
  },
  env: { browser: true },
  extends: [
    'eslint:recommended',
    'plugin:@typescript-eslint/recommended',
    'plugin:prettier/recommended',
  ],
  rules: {
    // eslint
    'consistent-return': 'warn',
    'curly': 'warn',
    'default-case-last': 'warn',
    'eqeqeq': 'error',
    'func-name-matching': 'error',
    'func-style': 'error',
    'no-lonely-if': 'warn',
    'no-multi-assign': 'error',
    'no-sequences': 'error',
    'no-unneeded-ternary': 'warn',
    'no-useless-rename': 'warn',
    'object-shorthand': ['warn', 'properties'],
    'operator-assignment': 'warn',
    'prefer-arrow-callback': 'warn',
    'prefer-object-spread': 'warn',
    'prefer-promise-reject-errors': 'error',
    'prefer-regex-literals': 'warn',
    'prefer-rest-params': 'error',
    'prefer-spread': 'warn',
    'prefer-template': 'warn',
    'spaced-comment': 'warn',

    // prettier
    'prettier/prettier': 'warn',
  },
  overrides: [
    {
      files: ['./.eslintrc.cjs', './*.config.{js,cjs,ts}'],
      parserOptions: { project: null },
      rules: {
        'import/no-nodejs-modules': 'off',
        'import/no-default-export': 'off',
      },
      env: { node: true },
    },
    {
      files: ['src/**/*.ts', 'tests/**/*.ts', 'src/**/*.svelte'],
      extends: [
        'plugin:@typescript-eslint/recommended-requiring-type-checking',
        'plugin:@typescript-eslint/strict',
      ],
      rules: {
        '@typescript-eslint/consistent-type-definitions': ['warn', 'type'],
        '@typescript-eslint/consistent-type-exports': 'warn',
        '@typescript-eslint/consistent-type-imports': 'warn',
        '@typescript-eslint/method-signature-style': 'warn',
        '@typescript-eslint/no-duplicate-type-constituents': 'warn',
        '@typescript-eslint/no-confusing-void-expression': [
          'warn',
          { ignoreArrowShorthand: true, ignoreVoidOperator: true },
        ],
        '@typescript-eslint/no-non-null-assertion': 'off',
        '@typescript-eslint/no-redundant-type-constituents': 'warn',
        '@typescript-eslint/no-require-imports': 'error',
        '@typescript-eslint/no-unnecessary-qualifier': 'warn',
        '@typescript-eslint/no-useless-empty-export': 'warn',
        '@typescript-eslint/prefer-enum-initializers': 'error',
        '@typescript-eslint/prefer-regexp-exec': 'warn',
        '@typescript-eslint/promise-function-async': 'error',
        '@typescript-eslint/switch-exhaustiveness-check': 'error',
      },
    },
    {
      files: ['src/**/*.svelte'],
      parser: 'svelte-eslint-parser',
      parserOptions: { parser: '@typescript-eslint/parser' },
      extends: ['plugin:svelte/all', 'plugin:svelte/prettier'],
      rules: {
        'svelte/block-lang': ['error', { script: 'ts', style: 'scss' }],
        'svelte/valid-compile': 'off',
        'svelte/prefer-destructured-store-props': 'off',
        'svelte/experimental-require-slot-types': 'off',
        'svelte/experimental-require-strict-events': 'off',
        'svelte/@typescript-eslint/no-unnecessary-condition': 'off',
        '@typescript-eslint/no-unused-vars': [
          'warn',
          { varsIgnorePattern: '^\\$\\$(Props|Events|Slots)$' },
        ],
      },
    },
  ],
};
